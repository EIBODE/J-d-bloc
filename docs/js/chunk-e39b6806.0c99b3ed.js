(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-e39b6806"],{"0a89":function(e,t,s){"use strict";var n=s("9f23"),i=s.n(n);i.a},"190b":function(e,t,s){"use strict";var n=s("f1ad"),i=s.n(n);i.a},"1c74":function(e,t,s){"use strict";var n=s("e87b"),i=s.n(n);i.a},2532:function(e,t,s){"use strict";var n=s("23e7"),i=s("5a34"),a=s("1d80"),r=s("ab13");n({target:"String",proto:!0,forced:!r("includes")},{includes:function(e){return!!~String(a(this)).indexOf(i(e),arguments.length>1?arguments[1]:void 0)}})},"44e7":function(e,t,s){var n=s("861d"),i=s("c6b6"),a=s("b622"),r=a("match");e.exports=function(e){var t;return n(e)&&(void 0!==(t=e[r])?!!t:"RegExp"==i(e))}},"5a34":function(e,t,s){var n=s("44e7");e.exports=function(e){if(n(e))throw TypeError("The method doesn't accept regular expressions");return e}},"6a7c":function(e,t,s){},"741f":function(e,t,s){"use strict";var n=s("ebef"),i=s.n(n);i.a},"7db0":function(e,t,s){"use strict";var n=s("23e7"),i=s("b727").find,a=s("44d2"),r=s("ae40"),l="find",o=!0,c=r(l);l in[]&&Array(1)[l]((function(){o=!1})),n({target:"Array",proto:!0,forced:o||!c},{find:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),a(l)},"9f23":function(e,t,s){},a15b:function(e,t,s){"use strict";var n=s("23e7"),i=s("44ad"),a=s("fc6a"),r=s("a640"),l=[].join,o=i!=Object,c=r("join",",");n({target:"Array",proto:!0,forced:o||!c},{join:function(e){return l.call(a(this),void 0===e?",":e)}})},a1d7:function(e,t,s){"use strict";var n=s("6a7c"),i=s.n(n);i.a},ab13:function(e,t,s){var n=s("b622"),i=n("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(s){try{return t[i]=!1,"/./"[e](t)}catch(n){}}return!1}},caad:function(e,t,s){"use strict";var n=s("23e7"),i=s("4d64").includes,a=s("44d2"),r=s("ae40"),l=r("indexOf",{ACCESSORS:!0,1:0});n({target:"Array",proto:!0,forced:!l},{includes:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),a("includes")},d7ac:function(e,t,s){"use strict";s.r(t);var n=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("app-game-layout",{scopedSlots:e._u([{key:"left",fn:function(){return[s("app-game-left-menu",{attrs:{players:e.players,captain:e.captain}})]},proxy:!0},{key:"right",fn:function(){return[e.player&&e.players?s("app-game-stats",{attrs:{players:e.players}}):e._e(),s("app-game-steps",{attrs:{players:e.players,messages:e.messages,captain:e.captain},on:{messageAction:function(t){return e.getMessageAction(t)}}})]},proxy:!0}])})},i=[],a=(s("7db0"),s("5530")),r=s("2f62"),l=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"game-layout-wrapper"},[s("div",{staticClass:"game-layout-title"},[s("div",{staticClass:"layout-left-header",on:{click:function(t){e.isOpenLeftMenu=!e.isOpenLeftMenu}}},[s("faIcon",{attrs:{icon:["fa","bars"]}})],1),s("div",{staticClass:"game-layout-title"},[s("div",{staticClass:"title"},[e._v(" "+e._s(e.$t("title.werewolf"))+" ")])])]),s("div",{staticClass:"game-layout-container"},[s("div",{staticClass:"layout-left",class:e.openClasses},[e.isOpenLeftMenu?e._t("left"):e._e()],2),s("div",{staticClass:"layout-right",class:e.openClasses},[e._t("right")],2)]),s("app-game-result-action"),e.isLoading?s("app-loading-state"):e._e()],1)},o=[],c=(s("d3b7"),function(){var e=this,t=e.$createElement,s=e._self._c||t;return e.resultAction.action?s("app-modal",{attrs:{title:e.getModalTitle,"open-modal":!!e.resultAction.action},on:{close:function(t){return e.clearResultAction()}}},[s("div",{staticClass:"result-action-player"},[e.resultAction.resume?s("div",{staticClass:"action-resume-wrapper"},e._l(e.resultAction.resume,(function(t){return s("div",{key:t.id,staticClass:"action-resume"},[s("span",{staticClass:"action-resume-title"},[e._v(e._s(e.$t("result-action."+t.from))+" "+e._s(t.selected.username))]),s("div",{staticClass:"action-resume-content"},[s("img",{attrs:{src:t.selected.picture,height:"90",width:"90"}}),e._v(" "),s("faIcon",{attrs:{icon:["fa","arrow-right"]}}),e._v(" "),s("img",{attrs:{src:e.getSourcePIctureRole(t.selected.role),height:"90",width:"90"}})],1)])})),0):e._e(),e.resultAction.player&&!e.resultAction.resume?s("div",{staticClass:"result-action-player-card"},[s("span",{staticClass:"result-action-player-title"},[e._v(" "+e._s(e._f("shorten")(e.resultAction.player.username,8))+" ")]),s("img",{attrs:{height:"90",width:"90",src:e.resultAction.player.picture}})]):e._e(),e.resultAction.showPartners?s("div",{staticStyle:{width:"100%",display:"flex","flex-wrap":"wrap","justify-content":"center"}},e._l(e.resultAction.showPartners,(function(t){return s("div",{key:t.id,staticClass:"result-action-player-card",staticStyle:{margin:"5px"}},[s("span",{staticClass:"result-action-player-title"},[e._v(" "+e._s(e._f("shorten")(t.username,8))+" ")]),s("img",{attrs:{height:"90",width:"90",src:t.picture}})])})),0):e._e()]),s("div",{staticClass:"result-action-action"},[s("app-button",{on:{click:function(t){return e.clearResultAction()}}},[e._v(" OK ")])],1)]):e._e()}),u=[],p=(s("99af"),function(){return s.e("chunk-60ef71d2").then(s.bind(null,"0178"))}),d={name:"AppGameResultAction",components:{AppModal:p},computed:{resultAction:function(){return this.$store.getters["resultAction/getResultAction"]},allMessage:function(){return this.$store.getters["meeting/allMessages"]},getModalTitle:function(){return this.$t("game.".concat(this.allMessage[this.resultAction.action]),{player:this.resultAction.player?this.resultAction.player.username:null,role:this.resultAction.player?this.$t("role.".concat(this.resultAction.player.role)):null})}},methods:{clearResultAction:function(){this.$store.dispatch("resultAction/clear")},getSourcePIctureRole:function(e){return"".concat("/my-kyhoot/","img/roles/").concat(e,".png")}}},f=d,h=(s("a1d7"),s("2877")),m=Object(h["a"])(f,c,u,!1,null,"072bd43e",null),y=m.exports,g=function(){return s.e("chunk-66026814").then(s.bind(null,"1e6b"))},v={components:{AppGameResultAction:y,AppLoadingState:g},data:function(){return{isOpenLeftMenu:!1}},computed:{isLoading:function(){return this.$store.getters["loader/isLoading"]},openClasses:function(){return[this.isOpenLeftMenu?"open":"close"]}}},_=v,b=(s("1c74"),Object(h["a"])(_,l,o,!1,null,null,null)),w=b.exports,A=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"left-player-list"},e._l(e.players,(function(t){return s("div",{key:t.id,staticClass:"left-player"},[s("div",{staticClass:"left-players-pictures"},[s("img",{attrs:{src:e.characterPictureSource(t),height:"90",width:"90"}}),e.isCaptain(t)?s("div",{staticClass:"captain"},[s("img",{attrs:{src:e.captainPictureSource(),height:"45",width:"45"}})]):e._e()]),s("span",{staticClass:"left-player-title"},[e._v(" "+e._s(e._f("shorten")(t.username,8))+" ")])])})),0)},O=[],P={name:"AppLeftMenu",props:{players:{type:Array,required:!0,default:function(){return[]}},captain:{type:String,required:!0,default:""}},methods:{characterPictureSource:function(e){return e.death?"".concat("/my-kyhoot/","img/roles/").concat(e.role,".png"):e.picture},captainPictureSource:function(){return"".concat("/my-kyhoot/","img/roles/captain.jpg")},isCaptain:function(e){return this.captain===e._id}}},C=P,S=(s("0a89"),Object(h["a"])(C,A,O,!1,null,"7151da2f",null)),$=S.exports,k=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"stats-wrapper"},[s("div",{staticClass:"stats"},[s("div",{staticClass:"role"},[s("div",{staticClass:"title",on:{click:function(t){e.isOpenRole=!e.isOpenRole}}},[e._v(" "+e._s(e.$t("title.your-role"))+" "),s("faIcon",{attrs:{icon:["fa",e.isOpenRole?"angle-up":"angle-down"]}})],1),e.isOpenRole?s("img",{attrs:{height:"90",width:"90",src:e.characterPictureSource(e.gamePlayer?e.gamePlayer.role:null)}}):e._e()]),s("div",{staticClass:"role-list",class:[{open:e.isOpenRole}]},[s("div",{staticClass:"title",on:{click:function(t){e.isOpenRoleList=!e.isOpenRoleList}}},[e._v(" "+e._s(e.$t("title.role-list"))+" "),s("faIcon",{attrs:{icon:["fa",e.isOpenRoleList?"angle-up":"angle-down"]}})],1),e._l(e.gameRoleList,(function(t){return s("div",{key:t.id},[e.isOpenRoleList?s("div",{staticClass:"game-role"},[s("img",{attrs:{height:"90",width:"90",src:e.characterPictureSource(t.role)}}),s("span",{staticClass:"game-role-size"},[e._v(e._s(t.size))])]):e._e()])}))],2)])])},M=[],R=(s("4de4"),{name:"AppGameStats",props:{players:{type:Array,required:!0}},data:function(){return{isOpenRole:!0,isOpenRoleList:!1}},computed:Object(a["a"])({gamePlayer:function(){var e=this;return this.players.find((function(t){return t._id===e.ownPlayer._id}))},gameRoleList:function(){var e=this;if(!this.players)return[];var t=[],s=function(s){var n=e.allRoles[s],i=e.players.filter((function(e){return e.role===n})).length;i>0&&t.push({role:n,size:i})};for(var n in this.allRoles)s(n);return t}},Object(r["b"])({ownPlayer:"player/getPlayer",allRoles:"player/getRoles"})),methods:{characterPictureSource:function(e){return e?"/my-kyhoot/img/roles/"+e+".png":"/my-kyhoot/img/players/anonymous.png"}}}),j=R,x=(s("190b"),Object(h["a"])(j,k,M,!1,null,"d82aa3e6",null)),I=x.exports,L=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"steps"},[s("div",{ref:"messages",staticClass:"messages-wrapper"},e._l(e.messages,(function(t){return s("div",{key:t.id,staticClass:"messages"},[s("div",{staticClass:"message"},[s("span",{staticClass:"message-header"},[e._v(" "+e._s(e.$t("contact."+t.writer))+": ")]),s("span",{staticClass:"message-message"},[e._v(" "+e._s(e.$t("game."+e.allMessages[t.message],{player:t.player?t.player.username:null,players:t.players?e.getPlayersUsernames(t.players):null}))+" ")]),t.action?s("div",{staticClass:"message-percent"},[s("div",{staticClass:"percent",style:"width: "+t.percent+"%"}),s("span",{staticStyle:{"z-index":"2"}},[e._v(" "+e._s(t.percent)+" % ")])]):e._e(),t.action&&e.canShowMessage(t.to)&&!e.isDoneAction(t.done)&&!e.gamePlayer.death?s("div",{staticClass:"message-action"},[s("app-button",{on:{click:function(t){e.isOpenModalSelectPlayer=!0}}},[e._v(" "+e._s(e.$t("label.select"))+" ")]),e.isOpenModalSelectPlayer?s(e.getActionComponent(t.action),{tag:"component",attrs:{"is-open":e.isOpenModalSelectPlayer,players:e.getPlayersByMessage(t.to,t.players)},on:{close:function(s){return e.receivePlayers(s,t.action)}}}):e._e()],1):e._e()])])})),0),e.isOpenNewMessages?s("div",{staticClass:"more-messages-wrapper"},[s("app-button",{staticClass:"more-messages",on:{click:function(t){return e.clickNewMessages()}}},[e._v(" "+e._s(e.$t("label.more-steps"))+" ")])],1):e._e()])},E=[],G=(s("caad"),s("a15b"),s("d81d"),s("2532"),function(){return s.e("chunk-255e1799").then(s.bind(null,"1a68"))}),T={name:"AppGameSteps",components:{selectCaptain:{props:["isOpen","players"],components:{AppSelectPlayers:G},methods:{submit:function(e){this.$emit("close",e)}},render:function(e){return e(G,{attrs:{title:this.$t("title.select-your-captain"),"is-open":this.isOpen,players:this.players,multiple:!1,howManySelected:1},on:{submit:this.submit}})}},clairvoyantSelect:{props:["isOpen","players"],components:{AppSelectPlayers:G},methods:{submit:function(e){this.$emit("close",e)}},render:function(e){return e(G,{attrs:{title:this.$t("title.select-player"),"is-open":this.isOpen,players:this.players,multiple:!1,howManySelected:1},on:{submit:this.submit}})}},werewolfSelect:{props:["isOpen","players"],components:{AppSelectPlayers:G},methods:{submit:function(e){this.$emit("close",e)}},render:function(e){return e(G,{attrs:{title:this.$t("title.select-victim"),"is-open":this.isOpen,players:this.players,multiple:!1,howManySelected:1},on:{submit:this.submit}})}},voteSelect:{props:["isOpen","players"],components:{AppSelectPlayers:G},methods:{submit:function(e){this.$emit("close",e)}},render:function(e){return e(G,{attrs:{title:this.$t("title.vote"),"is-open":this.isOpen,players:this.players,multiple:!1,howManySelected:1},on:{submit:this.submit}})}},captainSelect:{props:["isOpen","players"],components:{AppSelectPlayers:G},methods:{submit:function(e){this.$emit("close",e)}},render:function(e){return e(G,{attrs:{title:this.$t("title.select-player"),"is-open":this.isOpen,players:this.players,multiple:!1,howManySelected:1},on:{submit:this.submit}})}},changeCaptain:{props:["isOpen","players"],components:{AppSelectPlayers:G},methods:{submit:function(e){this.$emit("close",e)}},render:function(e){return e(G,{attrs:{title:this.$t("title.select-player"),"is-open":this.isOpen,players:this.players,multiple:!1,howManySelected:1},on:{submit:this.submit}})}}},props:{players:{type:Array,required:!0},messages:{type:Array,required:!0},captain:{type:String,required:!0}},data:function(){return{isOpenModalSelectPlayer:!1,isOpenNewMessages:!1}},computed:Object(a["a"])({token:function(){return localStorage.getItem("token")},gamePlayer:function(){var e=this;return this.players.find((function(t){return e.ownPlayer._id===t._id}))}},Object(r["b"])({ownPlayer:"player/getPlayer",allMessages:"meeting/allMessages"})),mounted:function(){var e=this;this.$ready((function(){e.clickNewMessages()}))},updated:function(){this.$refs.messages.scrollHeight-this.$refs.messages.offsetHeight-this.$refs.messages.scrollTop>=10?this.isOpenNewMessages=!0:this.$refs.messages.scrollTo(0,this.$refs.messages.scrollHeight)},methods:{getOwnPlayerInPlayers:function(){var e=this;return this.players.find((function(t){return t._id===e.ownPlayer._id}))},canShowMessage:function(e){return"*"===e||"captain"===e&&this.ownPlayer._id===this.captain||this.getOwnPlayerInPlayers()&&this.getOwnPlayerInPlayers().role===e&&!this.getOwnPlayerInPlayers().death},getActionComponent:function(e){return e},isDoneAction:function(e){return e.includes(this.token)},getPlayersByMessage:function(e,t){var s=this;return"captain"===e?t:this.players.filter((function(t){if(t._id===s.ownPlayer._id)return!1;switch(e){case"*":return!t.death;case"clairvoyant":return"clairvoyant"!==t.role&&!t.death;case"werewolf":return t.role!==e&&!t.death;default:return!1}}))},receivePlayers:function(e,t){this.$emit("messageAction",{players:e,action:t}),this.isOpenModalSelectPlayer=!1},clickNewMessages:function(){this.$refs.messages.scrollTo(0,this.$refs.messages.scrollHeight),this.isOpenNewMessages=!1},$ready:function(e){var t=this;setTimeout((function(){t.$nextTick(e)}),500)},getPlayersUsernames:function(e){return e.map((function(e){return e.username})).join(this.$t("label.and"))}}},N=T,q=(s("741f"),Object(h["a"])(N,L,E,!1,null,"649233e9",null)),z=q.exports,H={name:"AppGame",components:{AppGameLayout:w,AppGameLeftMenu:$,AppGameStats:I,AppGameSteps:z},data:function(){return{players:[],player:{},messages:[],captain:""}},computed:Object(a["a"])({token:function(){return localStorage.getItem("token")},meetingId:function(){return this.$route.params.gameId},gamePlayer:function(){var e=this;return this.players.find((function(t){return t._id===e.ownPlayer._id}))}},Object(r["b"])({ownPlayer:"player/getPlayer"})),mounted:function(){this.$socket.emit("joinRoom",this.meetingId),this.$store.dispatch("player/getPlayer"),this.$socket.emit("gameInit",{token:this.token,meetingIdentifier:this.meetingId})},sockets:{game:function(e){this.players=e.players,this.messages=e.steps,this.captain=e.captain},resultAction:function(e){"*"!==e.for&&e.for!==this.gamePlayer.role||this.$store.dispatch("resultAction/create",e)}},methods:{getMessageAction:function(e){var t=e.players,s=e.action;this.$socket.emit(s,{token:this.token,meetingIdentifier:this.meetingId,players:t})}}},B=H,D=Object(h["a"])(B,n,i,!1,null,null,null);t["default"]=D.exports},d81d:function(e,t,s){"use strict";var n=s("23e7"),i=s("b727").map,a=s("1dde"),r=s("ae40"),l=a("map"),o=r("map");n({target:"Array",proto:!0,forced:!l||!o},{map:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}})},e87b:function(e,t,s){},ebef:function(e,t,s){},f1ad:function(e,t,s){}}]);
//# sourceMappingURL=chunk-e39b6806.0c99b3ed.js.map